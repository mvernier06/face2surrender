<!DOCTYPE html>
<html>
<head>
    <title>Face2Surrender - Résultats</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/criminel.css" type="text/css">
</head>
<body>
    <div style="text-align: right;">
        <img src="../static/logo3.jpg" alt="Logo" style="height: 50px;">
        <span>Face2Surrender</span>
    </div>
    <h1>Evaluez chacun des profils</h1>
    <form id="imageSelectionForm"> <!-- Formulaire pour la sélection des images -->
      <div class="grid-container">
        {% for image in imgtmp %}
            <div class="grid-item" onclick="toggleSelection(this)">
                <img src="{{ url_for('static', filename=image.src) }}" alt="{{ image.alt }}">
                <input type="hidden" name="selected_images[]" value="{{ image.src }}"> <!-- Champ caché pour stocker les noms des images sélectionnées -->
            </div>
        {% endfor %}
      </div>
      <button type="button" class="bouton" onclick="submitSelectedImages()">Sélectionner les visages qui correspondent le mieux </button> <!-- Bouton pour soumettre le formulaire -->
    </form>

    <script>
    function toggleSelection(element) {
        element.classList.toggle('selected'); // Ajoute ou supprime la classe "selected" sur l'élément cliqué
    }

    function submitSelectedImages() {
        const selectedImages = document.querySelectorAll('.grid-item.selected img');
        const selectedImageNames = Array.from(selectedImages).map(img => img.alt);
        console.log(selectedImageNames); // Affiche les noms des images sélectionnées dans la console du navigateur
        // Envoyer une requête AJAX pour envoyer les noms des images sélectionnées au serveur Flask
        fetch('/criminel', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ selected_images: selectedImageNames }),
        })
        .then(response => {
            if (response.ok) {
                console.log('Images sélectionnées envoyées avec succès.');
                // Rafraîchir la page après avoir terminé le traitement
                window.location.reload();
            } else {
                console.error('Erreur lors de l\'envoi des images sélectionnées.');
            }
        })
        .catch(error => console.error('Erreur lors de l\'envoi des images sélectionnées :', error));
    }

    </script>

</body>
</html>
